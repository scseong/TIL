# 211105_TIL

## ì˜¤ëŠ˜ í•œ ì¼

- Reducer
- Context API



### Reducer

ë¦¬ì•¡íŠ¸ì—ì„œ ìƒíƒœê°’ì„ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œëŠ” setter í•¨ìˆ˜ë¥¼ ì§ì ‘ ì œê³µí•˜ëŠ” ë°©ë²•ê³¼ setter í•¨ìˆ˜ë¥¼ ì œê³µí•˜ì§€ ì•Šê³  dispatch í•¨ìˆ˜(Reduxì—ì„œì˜ ë°©ì‹)ë¥¼ ì œê³µí•˜ëŠ” ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. 

#### setter í•¨ìˆ˜ë¥¼ ì§ì ‘ ì œê³µ (useState)

```jsx
import React, { useState } from 'react';

const App = () => {
  const [person, setPerson] = useState({ name: '', age: '' });
  const { name, age } = person;
  console.log(name, age);

  const onChange = (e) => {
    const { name, value } = e.target;
    setPerson((prevState) => ({
      ...prevState,
      [name]: value,
    }));
  };

  return (
    <div>
      name: {name}, age: {age}
      <br />
      <input type="text" name="name" placeholder="name" onChange={onChange} />
      <input type="text" name="age" placeholder="age" onChange={onChange} />
    </div>
  );
};

export default App;
```

#### dispatch í•¨ìˆ˜ ì‚¬ìš© (useReducer)

```jsx
import React, { useReducer } from 'react';

const INITIAL_STATE = {
  myname: '',
  age: '',
};

const SET_NAME = 'SET_NAME';
const SET_AGE = 'SET_AGE';

const reducer = (prevState, action) => {
  const { type, value } = action;
  switch (type) {
    case SET_NAME:
      return { ...prevState, myname: value };
    case SET_AGE:
      return { ...prevState, age: value };
    default:
      return null;
  }
};

const App = () => {
  const [state, dispatch] = useReducer(reducer, INITIAL_STATE);
  const { myname, age } = state;
  const onChange = (e) => {
    const { name: type, value } = e.target;
    dispatch({ type, value });
  };

  return (
    <div>
      name: {myname}, age: {age}
      <br />
      <input
        type="text"
        name="SET_NAME"
        placeholder="name"
        onChange={onChange}
      />
      <input type="text" name="SET_AGE" placeholder="age" onChange={onChange} />
    </div>
  );
};

export default App;
```



#### useReducer

> [`useState`](https://ko.reactjs.org/docs/hooks-reference.html#usestate)ì˜ ëŒ€ì²´ í•¨ìˆ˜ì…ë‹ˆë‹¤. `(state, action) => newState`ì˜ í˜•íƒœë¡œ reducerë¥¼ ë°›ê³  `dispatch` ë©”ì„œë“œì™€ ì§ì˜ í˜•íƒœë¡œ í˜„ì¬ stateë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. 
> https://ko.reactjs.org/docs/hooks-reference.html#usereducer

ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒ¯ê°’ì„ ë¦¬ë•ìŠ¤ì˜ ë¦¬ë“€ì„œì²˜ëŸ¼ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. stateê°€ ë§ì•„ì§€ë©´ state ê´€ë¦¬ì™€ props ì „ë‹¬ì´ ì–´ë µê³  ë³µì¡í•œ ë¡œì§ì´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. useReducerë¥¼ ì‚¬ìš©í•˜ë©´ í•˜ë‚˜ì˜ stateì™€ setStateë¡œ í†µí•©í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆì–´ ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶„ë¦¬ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Context APIì™€ ê°™ì´ ì´ìš©í•˜ë©´ ê¹Šì€ íŠ¸ë¦¬ì˜ ìì‹ ì»´í¬ë„ŒíŠ¸ì—ê¹Œì§€ dispatch ì „ë‹¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.

`const [state, dispatch] = useReducer(reducer, initialState)`

- state: reducerê°€ ê´€ë¦¬í•˜ëŠ” ìƒíƒœê°’

- dispatch: ì•¡ì…˜ì„ ë°œìƒì‹œì¼œ reducer í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒíƒœê°’ì„ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜

- reducer: dispatchë¡œë¶€í„° action ê°ì²´ë¥¼ ë°›ì•„ setter ë¡œì§ì„ êµ¬í˜„í•œ í•¨ìˆ˜ (í˜„ì¬ ìƒíƒœì™€ ì•¡ì…˜ ê°ì²´ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì™€ì„œ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë°˜í™˜)



#### ì •ë¦¬

ê¸°ì¡´ stateë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•Šê³ (ë¶ˆë³€ì„±) ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ actionì„ dispatchí•´ì„œ stateì„ ë³€ê²½í•©ë‹ˆë‹¤. actionì„ ì²˜ë¦¬í•  ë°©ë²•ì€ reducerì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤(stateë¥¼ ì–´ë–»ê²Œ ë³€ê²½í•  ê²ƒì¸ì§€).



### Context API

#### Context APIì˜ í•„ìš”ì„±

ì—¬ëŸ¬ ë‹¨ê³„ì— ê±¸ì³ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ ì†ì„±ê°’ì„ ì „ë‹¬í•  ë•Œì—ëŠ” ê° ë‹¨ê³„ë³„ë¡œ ì†ì„±ê°’ì„ ì „ë‹¬í•˜ëŠ” ì½”ë“œë¥¼ ê¸°ê³„ì /ë°˜ë³µì ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ìˆìŠµë‹ˆë‹¤. Context APIë¥¼ í™œìš©í•˜ë©´ ì—¬ëŸ¬ ë‹¨ê³„ì— ê±¸ì³ ë¶ˆí•„ìš”í•˜ê²Œ propsë¥¼ ë„˜ê¸°ì§€ ì•Šê³ ë„ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì— ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



#### createContext

`const MyContext = React.createContext(defaultValue);`


> Context ê°ì²´ë¥¼ ë§Œë“­ë‹ˆë‹¤. Context ê°ì²´ë¥¼ êµ¬ë…í•˜ê³  ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•  ë•Œ ReactëŠ” íŠ¸ë¦¬ ìƒìœ„ì—ì„œ ê°€ì¥ ê°€ê¹Œì´ ìˆëŠ” ì§ì´ ë§ëŠ” `Provider`ë¡œë¶€í„° í˜„ì¬ê°’ì„ ì½ìŠµë‹ˆë‹¤.
> https://ko.reactjs.org/docs/context.html#reactcreatecontext



ProviderëŠ” contextë¥¼ êµ¬ë…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì—ê²Œ contextì˜ ë³€í™”ë¥¼ ì•Œë¦¬ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.  Provider ì»´í¬ë„ŒíŠ¸ëŠ” `value` propì„ ë°›ì•„ì„œ ì´ ê°’ì„ í•˜ìœ„ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤. 

í•´ë‹¹ valueê°€ ë³€ê²½ë  ê²½ìš° í•˜ìœ„ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ë©ë‹ˆë‹¤. ğŸ‘‰ useMemoë¥¼ ì‚¬ìš©í•˜ì—¬ ìºì‹±

```jsx
const MessageContext = crateContext('default message')

const App = () => {
    // Consumerì—ì„œ Provider ì°¾ê¸°ì— ì‹¤íŒ¨í–ˆì„ ê²½ìš°ì— ì‚¬ìš©ë  ê¸°ë³¸ê°’
    <MessageContext.Provider value="Hello Context API">
        <Level1 />
    </MessageContext.Provider>
}

const Level1 = () => <div>Level1<Level2 /></div>
const Level2 = () => <div>Level2<Level3 /></div>
const Level3 = () => (
	<div>
        // ìƒìœ„ë¡œ ì˜¬ë¼ê°€ë©° ê°€ê¹Œìš´ Providerë¥¼ ì°¾ê³  ê´€ë ¨ Providerê°€ ì—†ì„ ê²½ìš°, ê¸°ë³¸ê°’ ì‚¬ìš©
    	<MessageContext.Consumer>
            // Consumer ë‚´ì˜ childrenì€ í•„íˆ í•¨ìˆ˜ë¡œë§Œ ì ìš©í•´ì•¼ ê°’ì„ ë°›ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        	{message => `Level 3: ${message`}}
        </MessageContext.Consumer>
    </div>
)
```



#### useReducer + createContext

Context APIì™€ dispatch ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ë³µì¡í•œ êµ¬ì¡°ë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
import React, {useState, createContext, useReducer} from 'react'

const CounterContext = createContext()

const INCREMENT = 'COUNTER/INCREMENT'
const DECREMENT = 'COUNTER/DECREMENT'

const reducer = (prevState, action) => {
    const { type, payload: value = 1 } = action
    siwtch(type) {
        case INCREMENT: return prevState + value
        case DECREMENT: return prevState - value
        default: return prevState
	}
}

// dispatch í•  ë•Œ object êµ¬ì¡°ê°€ ë³µì¡í•  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ ..
const actionIncrement = (value) => ({ type: INCREMENT, payload: value })
const actionDecrement = (value) => ({ type: DECREMENT, payload: value })

const App = () => {
	const [state, dispatch] = useReducer(reducer, 0)
    
    return (
    	<div>
        	<h1 onClick={() => dispatch(actionDecrement(10))})>App</h1>
            <CounterContext.Provider value={{ state, dispatch }}>
            	<GameBox />
            </CounterContext.Provider>
        </div>
    )
}

const GameBox = () => {
    const { state: countValue, dispatch } = useReducer(CounterContext)
    const onClick = () => {
		dispatch(actionIncrement(5))
    }

    return (
    	<div>
        	<h2>GameBox</h2>
            <button onClick={onClick}>{countValue}</button>
        </div>
    )
}

export default App
```




## ì°¸ê³ ìë£Œ

[useReducer ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ ë¶„ë¦¬í•˜ê¸°](https://react.vlpt.us/basic/20-useReducer.html)

[Context API ë¥¼ ì‚¬ìš©í•œ ì „ì—­ ê°’ ê´€ë¦¬](https://react.vlpt.us/basic/22-context-dispatch.html)

[react context api ê°œë… & ì˜ˆì‹œ](https://kyounghwan01.github.io/blog/React/react-context-api/#api)

[Context - React](https://ko.reactjs.org/docs/context.html#gatsby-focus-wrapper)

