# 211129_TIL

## 오늘 한 일

- 인증과 인가
- 쿠키/세션
- 토큰



### 인증과 인가

- **인증(Authentication)**: 식별가능한 정보로 서버에 등록된 유저의 신원을 입증하는 과정
  특정 서비스에 일정 권한이 주어진 사용자임을 아이디, 패스워드 등을 통해서 인증

- **인가(Authorization)**: 인증된 사용자에 대한 자원 접근 권한 확인
  한 번 인증을 받은 사용자가 이후 서비스의 여러 기능을 사용할 때 권한이 있는지 확인



세션과 토큰이 필요한 이유는 인증과 인가를 위함입니다. 사용자가 로그인을 위해 서버에 요청을 보내려고 합니다. 사용자는 아이디와 비밀번호를 서버에 전송할 것입니다. 그리고선 서버가 자신의 정보를 가지고 있을 것이라고 기대하지만 그렇지 않습니다. HTTP의 특성인 무상태성(Stateless) 떄문입니다.

> 컴퓨팅에서 **무상태 프로토콜**(stateless protocol)은 어떠한 이전 요청과도 무관한 각각의 요청을 독립적인 트랜잭션으로 취급하는 [통신 프로토콜](https://ko.wikipedia.org/wiki/통신_프로토콜)로, 통신이 독립적인 쌍의 요청과 응답을 이룰 수 있게 하는 방식이다. 
> https://ko.wikipedia.org/wiki/%EB%AC%B4%EC%83%81%ED%83%9C_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C

서버로 가는 모든 요청이 독립적으로 다뤄지기 때문에 요청이 끝나면 서버는 클라이언트의 정보를 유지하지 않습니다. 따라서, 클라이언트는 요청할 때마다 자신이 누구인지 알려줘야 할 것입니다.



### 쿠키/세션

서버가 클라이언트를 식별하는, 클라이언트의 정보를 유지하는 방법 중 하나가 바로 **세션(Session)**입니다. 클라이언트에서 요청을 보내면 서버는 클라이언트를 식별할 수 있는 세션 ID를 생성합니다. 서버는 응답헤더 필드 `set-cookie` 값으로 세션 ID를 담아 클라이언트에게 전달합니다. 

클라이언트의 브라우저는 전달 받은 세션 ID를 쿠키에 저장하며 인증이 필요한 요청마다 쿠키를 헤더에 실어서 서버에 전달합니다. 서버에서는 쿠키를 받아 세션 저장소에서 대조를 한 후 매칭되는 정보를 보내줍니다.

> **쿠키(Cookie)란?**
>
> 사용자가 방문한 웹페이지에서 이용된 환경설정 및 기타 정보를 사용자의 컴퓨터에 저장하는 작은 파일입니다.
> https://support.google.com/google-ads/answer/2407785?hl=ko

정리하자면, 세션 ID를 사용해서 서버에 로그인이 지속되는 상태를 세션이라고 하며 서버가 보낸 데이터를 저장하는 공간인 쿠키를 매개로 인증을 합니다.



#### (+) 쿠키와 세션 비교

| 구분      | 쿠키             | 세션             |
| --------- | ---------------- | ---------------- |
| 저장 위치 | 클라이언트       | 웹 서버          |
| 저장 형식 | text             | object           |
| 만료시간  | 쿠키 저장시 설정 | 브라우저 종료 시 |
| 속도      | 비교적 빠름      | 비교적 느림      |
| 사용 예   | 자동로그인       | 로그인 유지      |



### 토큰

쿠키/세션 방식은 사용자가 늘어날수록 서버에 부하를 줍니다. 세션은 모든 사용자의 세션 정보를 가지고 있어야 하므로 서버 메모리를 많이 사용하게 됩니다. 요청이 들어올 때마다 쿠키를 받아 세션 ID를 가지고 일치하는 유저를 찾아야 하기 때문입니다. 또한, 쿠키는 브라우저에만 있으므로 iOS나 Android 앱에서는 사용할 수 없습니다. 이 경우 토큰을 사용합니다.

토큰(token)은 인증을 위해 사용되는 암호화된 문자열입니다.  서버는 유저를 인증하는데 필요한 정보를 토큰에 저장해 클라이언트에게 전달합니다. 쿠키/세션 방식과는 달리 토큰을 사용하면 요청을 받은 서버는 해당 토큰이 유효한지만 검증합니다. 따라서, 세션 저장소를 갖을 필요가 없고 서버는 유저 인증을 위해 많은 일을 하지 않아도 됩니다.



## 참고자료

[인증(Authentication)과 인가(Authorization)](https://ivorycode.tistory.com/entry/%EC%9D%B8%EC%A6%9DAuthentication%EA%B3%BC-%EC%9D%B8%EA%B0%80Authorization)

[[10분 테코톡] 🎡토니의 인증과 인가](https://www.youtube.com/watch?v=y0xMXlOAfss)

[먹는 쿠키 말고 IT 쿠키와 친구들 (세션,토큰,캐시)](https://brunch.co.kr/@b30afb04c9f54dc/7)

[세션 vs 토큰 vs 쿠키? 기초개념 잡아드림. 10분 순삭! - YouTube](https://www.youtube.com/watch?v=tosLBcAX1vk)

[세션 VS. 토큰! JWT가 뭔가요? - YouTube](https://www.youtube.com/watch?v=1QiOXWEbqYQ)

